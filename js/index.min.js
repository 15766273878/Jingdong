window.onload=function(){searchBar();sktime(2*3600);slider();}
function searchBar(){ var headerBox=document.querySelector('.jd_header_box'); var banner=document.querySelector('.jd_banner') 
var height=banner.offsetHeight;var opacity=0; window.onscroll=function(){var scrollTop=document.documentElement.scrollTop||document.body.scrollTop; if(scrollTop<height){ opacity=scrollTop/height*0.85;}else{ opacity=0.85;}
headerBox.style.background='rgba(201, 21, 35, '+opacity+')';}}
function sktime(sk){ var sktime=document.querySelector('.sk_time') 
var spans=sktime.children;sktime.sk=sk; updateSktime(spans,sktime.sk); sktime.timer=setInterval(function(){sktime.sk--;if(sktime.sk<0){clearInterval(sktime.timer);return;}
updateSktime(spans,sktime.sk);},1000);}
function updateSktime(spans,sk){var hours=Math.floor(sk/3600);var minutes=Math.floor(sk%3600/60);var seconds=sk%60; if(hours>9){spans[0].innerHTML=Math.floor(hours/10);spans[1].innerHTML=hours%10;}else{spans[0].innerHTML=0;spans[1].innerHTML=hours;} 
if(minutes>9){spans[3].innerHTML=Math.floor(minutes/10);spans[4].innerHTML=minutes%10;}else{spans[3].innerHTML=0;spans[4].innerHTML=minutes;} 
if(seconds>9){spans[6].innerHTML=Math.floor(seconds/10);spans[7].innerHTML=seconds%10;}else{spans[6].innerHTML=0;spans[7].innerHTML=seconds;}}
function slider(){ var banner=document.querySelector('.jd_banner');var imgUl=banner.children[0];var dotUl=banner.children[1];var width=banner.offsetWidth;var current=1;banner.timeInterval=5000; clearInterval(banner.timer);banner.timer=setInterval(function(){current++;jd.addTransition(imgUl); var dis=-current*width;
jd.setTransform(imgUl,dis,'x');},banner.timeInterval);jd.addTransitionEnd(imgUl,function(){if(current>imgUl.children.length-2){current=1;}else if(current==0){current=imgUl.children.length-2;}
jd.removeTransition(imgUl);jd.setTransform(imgUl,-current*width,'x');updateDot();}); function updateDot(){for(var i=0;i<dotUl.children.length;i++){dotUl.children[i].className='';}
dotUl.children[current-1].className='active';} 
imgUl.addEventListener('touchstart',function(e){ clearInterval(banner.timer);imgUl.startX=e.touches[0].pageX;});imgUl.addEventListener('touchmove',function(e){ imgUl.isMove=true;imgUl.endX=e.touches[0].pageX; imgUl.distance=imgUl.endX-imgUl.startX;jd.removeTransition(imgUl);jd.setTransform(imgUl,-current*width+imgUl.distance,'x');});imgUl.addEventListener('touchend',function(){if(imgUl.isMove){ if(Math.abs(imgUl.distance)>width/3){ if(imgUl.distance>0){current--;}else{current++;}
jd.addTransition(imgUl);jd.setTransform(imgUl,-current*width,'x');}else{ jd.addTransition(imgUl);jd.setTransform(imgUl,-current*width,'x');}}
clearInterval(banner.timer)
banner.timer=setInterval(function(){current++;jd.addTransition(imgUl);jd.setTransform(imgUl,-current*width,'x');},banner.timeInterval);});}